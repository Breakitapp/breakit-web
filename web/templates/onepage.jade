!!! 5
html
	head
		title = title
		meta(property="og:url",content="http://breakitapp.com/p/#{b._id}")
		meta(property="og:image",content="http://breakitapp.com/ios/picture/#{b._id}")
		meta(property="og:site_name",content=title)
		meta(property="og:title",content=title)
		meta(property="og:type",content="website")
		meta(property="fb:app_id",content="410947535627985")
		meta(property="og:description",content="#{b.story}")
		link(rel="image_src",href="http://breakitapp.com/ios/picture/#{b._id}")
		link(rel='stylesheet', href='/public/css/onepager.css')
		link(href="/public/css/jScrollPane.css", rel="stylesheet", type="text/css")
		link(href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700', rel='stylesheet', type='text/css')
		script(src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js")
		script(type='text/javascript', src='http://www.datejs.com/build/date.js')
		script(type="text/javascript", src="/public/js/mousewheel.js")
		script(type="text/javascript", src="/public/js/jScrollPane.js")
		script(type="text/javascript", src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBDhH--9TqUDZx3LmS9X6SClmyFEplBZeA&sensor=false")
		script(type="text/javascript", src="/public/js/jqueryCookies.js")
		script(type="text/javascript")
			//initialize function that gets the google map with the help of google API
			function initialize(){
				var lat = #{b.loc.lat}
				var lan = #{b.loc.lon}
				var mapOptions = {
					center: new google.maps.LatLng(lat, lan),
					zoom: 13,
					disableDefaultUI: true,
					panControl: false,
					zoomControl: true,
					scaleControl: false,
					marker:true,
					mapTypeId: google.maps.MapTypeId.ROADMAP
				};
				//create the map
					var map = new google.maps.Map(document.getElementById("map"), mapOptions);
					//Location for the marker
					var location = new google.maps.LatLng(lat, lan);
					//Add the marker
					var marker = new google.maps.Marker({
						position:location,
							map:map
					})
			}
		//[if lte IE 7]>
			style
				#bottomRight
				{
					width:370px;
				}
				#bottomLeft ul
				{
					clear:both;
					width:250px;
				}
				#bottomLeft
				{
					width:612px;
				}
			<![endif]
	//onLoad starts the function initialize()
	body(onLoad="initialize();")
		//Facebook
		div(id="fb-root")
			script
				(function(d, s, id) {
					var js, fjs = d.getElementsByTagName(s)[0];
					if (d.getElementById(id)) return;
					js = d.createElement(s); js.id = id;
					js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=410947535627985";
					fjs.parentNode.insertBefore(js, fjs);
				}
				(document, 'script', 'facebook-jssdk'));
		//Twitter
		script
			!function(d,s,id){
				var js,fjs=d.getElementsByTagName(s)[0];
				if(!d.getElementById(id)){
					js=d.createElement(s);
					js.id=id;js.src="//platform.twitter.com/widgets.js";
					fjs.parentNode.insertBefore(js,fjs);
				}
			}
			(document,"script","twitter-wjs");
		header
			if (typeof mediaInterface != 'undefined')
					if (mediaInterface == true)
						a.button.left(href="/media") back
						mediaInterface = 'media';
					else
						mediaInterface = '';
			#header.centrify
				h1 Break
					span it
		#wrapper.centrify.fullRadius.fullBorder.insetShadow.clear
			#borderDiv.outsetShadow
				#middleContainer.clear
					#leftContainer.left
						.floatHeadline
							h1 #{b.headline}
						img(src="/ios/picture/"+b._id, alt="break")
					#rightContainer.right
						#address
							h1 #{b.placeName}
						#map.fullBorderRidge.bottomMargin
						#commentField.fullBorderGroove.scroll-pane
						
							storydate = b.date
							storydate = storydate.toString().substring(0,storydate.toString().length-20)
							storydate = Date.parse(storydate)
							newDate = Date.now() - storydate
							hours = newDate/(1000*60*60)
							if hours > 24
									days = Math.round(hours/24)
									if days > 30
										months = Math.round(days/30)
										h4.right #{months}M ago
									else
										h4.right #{Math.round(days)}d ago
								else
									h4.right #{Math.round(hours)}h ago
							p #{b.usernick}: 
								span #{b.story}
							hr.centrify
							for comment in b.comments
								fdate = comment.date
								fdate = fdate.toString().substring(0,fdate.toString().length-20)
								fdate = Date.parse(fdate)
								newDate = Date.now() - fdate
								hours = newDate/(1000*60*60)
								if hours > 24
									days = Math.round(hours/24)
									if days > 30
										months = Math.round(days/30)
										h4.right #{months}M ago
									else
										h4.right #{Math.round(days)}d ago
								else
									h4.right #{Math.round(hours)}h ago
								p #{comment.usernick}: 
									span #{comment.comment}
								hr.centrify
										
				#bottomContainer.clear
					#bottomLeft.left
						img.left(src="/public/images/1pager/profile.png")
						p.left #{b.usernick}: 
							span #{b.story}
						ul.right
							li.twitter
								a(href="https://twitter.com/share",class="twitter-share-button",data-text="#{b.headline}",data-url="http://breakitapp.com/#{b._id}",data-via="Breakitapp",data-count="vertical", data-size="medium") Tweet
							li.fbook
								div(class="fb-like",data-href="http://breakitapp.com/p/#{b._id}",data-send="false",data-layout="box_count",data-width="60",colorscheme="light",data-width="60",width="60px",data-show-faces="false",data-font="arial",data-action="like")							
							li.viewAmount
								img(src="/public/images/1pager/viewsIcon.fw.png")
								views = b.views;
								countK = 0;
								countHundred = 0;
								if (views>999)
									while (views>999)
										countK = countK + 1;
										views = views-1000;
									while (views > 99)
										countHundred = countHundred + 1;
										views = views - 100
										
									p= countK + '.' + countHundred + 'K'
								else
									P= views
							li.comments_count
								img(src="/public/images/1pager/comments.png")
								p #{b.comments.length}
					#bottomRight.right
						form(name="post_comment", action="/p/comment", method="post")
							textarea.left.fullBorderRidge.smallRadius.insetShadow(name = "comment") Write comment here
							input.hideInput(name = "userId", value=u) 
							input.hideInput(name = "breakId", value=b._id)							
							input.hideInput(name = "mediaInterface", value=mediaInterface)
							input.right(type="button", onClick="submitForm()", value="send")
	script
		$(document).ready(function(e) {
			$("li").mouseover(function() {
				if($(this).hasClass("comments_count")){
					$(this).find("p").css("color","#2A30E8");
				}
				else if($(this).hasClass("viewAmount")){
					$(this).find("p").css("color","#5B5B5B");
				}
			});
			$("li").mouseout(function() {
				if($(this).hasClass("comments_count")){
					$(this).find("p").css("color","white");
				}
				else if($(this).hasClass("viewAmount")){
					$(this).find("p").css("color","#A1A1A1");
				}
			});
			$("textarea").focus(function() {
				if($(this).val() == 'Write comment here'){
					$(this).val('');
				}
			});
			$("textarea").focusout(function() {
				if($(this).val() == ''){
					$(this).val('Write comment here');
				}
			});
			$(function(){
				$('.scroll-pane').jScrollPane();
			});
			$(function(){
				if($.cookie('breakit') === null) {
					$.cookie('breakit', '#{b.id}' , {expires:1});
				}
				else if($.cookie('breakit') != "#{b.id}"){
					$.cookie("breakit", null);
					$.cookie('breakit', '#{b.id}' , {expires:1});
				}
			});
		});
		function submitForm(){
			if($("textarea").val() == '' || $("textarea").val() == 'Write comment here'){
				alert("You have to type in a comment");
			}
			else{
				$("form[name=post_comment]").submit();
			}
		}